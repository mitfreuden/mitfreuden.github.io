---
import { getRelativeLocaleUrl } from "astro:i18n";
const homeUrl = getRelativeLocaleUrl(Astro.currentLocale, "/");

const navLinksMap = {
  en: [
    { label: "Solutions", href: `#solutions` },
    { label: "Team", href: `#team` },
    { label: "Contact", href: `mailto:hello@mitfreuden.com` },
  ],
  de: [
    { label: "Angebot", href: `#angebot` },
    { label: "Team", href: `#team` },
    { label: "Kontakt", href: `mailto:hallo@mitfreuden.com` },
  ],
};
const navLinks = navLinksMap[Astro.currentLocale];
---

<nav>
  <!-- Hamburger button (mobile only) -->
  <button
    class="hamburger group relative z-50 flex h-8 w-8 flex-col items-center justify-center gap-1.5 md:hidden"
    aria-label="Toggle menu"
    aria-expanded="false"
  >
    <span
      class="hamburger-line h-0.5 w-6 origin-center bg-gray-900 transition-all duration-300 group-[.is-open]:translate-y-2 group-[.is-open]:rotate-45"
    ></span>
    <span
      class="hamburger-line h-0.5 w-6 bg-gray-900 transition-all duration-300 group-[.is-open]:opacity-0"
    ></span>
    <span
      class="hamburger-line h-0.5 w-6 origin-center bg-gray-900 transition-all duration-300 group-[.is-open]:-translate-y-2 group-[.is-open]:-rotate-45"
    ></span>
  </button>

  <!-- Navigation links -->
  <div class="nav-links hidden justify-between gap-8 md:flex">
    {
      navLinks.map((link) => (
        <a
          href={link.href}
          class="text-neutral-500 transition-colors hover:underline"
        >
          {link.label}
        </a>
      ))
    }
  </div>

  <!-- Mobile menu -->
  <div
    class="mobile-menu fixed inset-0 z-40 hidden h-dvh flex-col bg-neutral-50 px-4 py-2 sm:px-6 [.is-open&]:flex"
  >
    <a href={homeUrl} class="site-logo">
      <div class="flex items-center gap-1">
        <div
          class="inline-block bg-linear-to-tr from-rose-600 via-rose-400 to-orange-300 bg-clip-text text-xl font-light tracking-tight text-transparent lg:text-2xl"
        >
          Mit Freuden
        </div>
        <svg
          class="h-8 lg:h-10"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 40 40"
          stroke="url(#grad1)"
        >
          <!-- Square Brackets [ ] - happy eyes ^^ -->
          <defs>
            <linearGradient id="grad1" x1="0%" y1="50%" x2="20%" y2="0%">
              <stop
                offset="0%"
                style="stop-color:var(--color-rose-400);stop-opacity:1"></stop>
              <stop
                offset="100%"
                style="stop-color:var(--color-orange-400);stop-opacity:1"
              ></stop>
            </linearGradient>
          </defs>
          <g>
            <path
              d="M 10 4 L 4 4 L 4 36 L 10 36"
              fill="none"
              stroke-width="1.5"
              stroke-linecap="round"></path>
            <path
              d="M 30 4 L 36 4 L 36 36 L 30 36"
              fill="none"
              stroke-width="1.5"
              stroke-linecap="round"></path>
            <path
              d="M 10 24 Q 20 32 30 24"
              fill="none"
              stroke-width="1.5"
              stroke-linecap="round"></path>
            <path
              d="M 12 18 Q 14 15 16 18"
              stroke-width="1.5"
              stroke-linecap="round"
              fill="none"></path>
            <path
              d="M 24 18 Q 26 15 28 18"
              stroke-width="1.5"
              stroke-linecap="round"
              fill="none"></path>
          </g>
        </svg>
      </div>
    </a>
    <div class="flex grow flex-col items-center justify-center gap-10 text-2xl">
      {
        navLinks.map((link) => (
          <a
            href={link.href}
            class="mobile-menu-link transition-colors hover:underline"
          >
            {link.label}
          </a>
        ))
      }
    </div>
  </div>
</nav>

<script>
  const hamburger = document.querySelector(".hamburger");
  const mobileMenu = document.querySelector(".mobile-menu");
  const mobileMenuLinks = document.querySelectorAll(".mobile-menu-link");

  if (hamburger && mobileMenu) {
    hamburger.addEventListener("click", () => {
      const isOpen = hamburger.classList.toggle("is-open");
      mobileMenu.classList.toggle("is-open");
      hamburger.setAttribute("aria-expanded", isOpen.toString());

      // Prevent body scroll when menu is open
      document.body.style.overflow = isOpen ? "hidden" : "";
    });

    // Close menu when a link is clicked
    mobileMenuLinks.forEach((link) => {
      link.addEventListener("click", () => {
        hamburger.classList.remove("is-open");
        mobileMenu.classList.remove("is-open");
        hamburger.setAttribute("aria-expanded", "false");
        document.body.style.overflow = "";
      });
    });
  }
</script>
